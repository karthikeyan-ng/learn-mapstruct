# Learn [MapStruct](https://mapstruct.org/)
It is a Java based property mapper library.

Steps to incorporate this utility in your application:
   1. Add maven dependencies as follows
```xml
<properties>
    <org.mapstruct.version>1.3.1.Final</org.mapstruct.version>
</properties>
<dependencies>
   <dependency>
        <groupId>org.mapstruct</groupId>
        <artifactId>mapstruct</artifactId>
        <version>${org.mapstruct.version}</version>
    </dependency>
</dependencies>
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>3.8.0</version>
            <configuration>
                <source>1.11</source>
                <target>1.11</target>

                <annotationProcessorPaths>
                    <path>
                        <groupId>org.mapstruct</groupId>
                        <artifactId>mapstruct-processor</artifactId>
                        <version>${org.mapstruct.version}</version>
                    </path>
                    <path>
                        <groupId>org.projectlombok</groupId>
                        <artifactId>lombok</artifactId>
                        <version>${lombok.version}</version>
                    </path>
                </annotationProcessorPaths>
                <compilerArgs>
                    <compilerArg>-Amapstruct.defaultComponentModel=spring</compilerArg>
                </compilerArgs>
            </configuration>
        </plugin>
    </plugins>
</build>
```
Create a respective POJO classes as shown below
```java
package com.techstack.demo.vo;

import lombok.Builder;
import lombok.Data;

@Data @Builder
public class Address {

    private CountryCode countryCode;
    private String cityName;
    private int houseNumber;
    private String houseNumberExtension;
    private String postalAddressName;
    private String postalCode;
    private String streetAddress;
    private String streetName;
    private String streetSuffix;
    private String shortCityName;
    private String shortStreetName;

}

import lombok.Builder;
import lombok.Data;

import java.io.Serializable;

@Data @Builder
public class AddressVO implements Serializable {
    private static final long serialVersionUID = -822837896213811708L;

    private String streetName;
    private String streetSuffix;
    private String postalCode;
    private String houseNumber;
    private String houseNumberExtension;
    private String cityName;
    private String countryName;
    private String countryCode;
}
```

Create a mapper class for your scenario (ex. to transfer properties from Address to AddressVO and vise versa)
```java
package com.techstack.demo.mapper;


import com.techstack.demo.vo.Address;
import com.techstack.demo.vo.AddressVO;
import org.mapstruct.InheritInverseConfiguration;
import org.mapstruct.Mapper;
import org.mapstruct.Mapping;
import org.mapstruct.Mappings;
import org.mapstruct.factory.Mappers;

@Mapper(componentModel = "spring")
public interface AddressMapper {

    AddressMapper MAPPER = Mappers.getMapper(AddressMapper.class);

    @Mappings({
            @Mapping(source = "address.countryCode.localName", target = "countryName"),
            @Mapping(target = "houseNumber", expression = "java(Integer.toString(address.getHouseNumber()))"),
            @Mapping(source = "address.countryCode.code", target = "countryCode"),
    })
    AddressVO addressToAddressVO(Address address);

    @InheritInverseConfiguration
    Address addressVOToAddress(AddressVO addressVO);
}
```

Enable IDE support inorder to identify your Mapper class by MapStruct lib for annotation process. On Mac,
```text
IntelliJ IDEA 
    Preferences
        Build, Execution, Deployment 
            Compiler
                Annotation Processors
                    [x] Enable Annotation Processor
                        [Apply] [Ok]
```

Execute Maven clean compile 
```text 
mvn clean compile
```

Verify MapStruct annotation processor generated classes
```text
target/clasess/<navigate-to-your-mapper-interface-package-folder>/AddressMapperImpl.class
```
This .class file is generated by IntelliJIDEA
```java
//
// Source code recreated from a .class file by IntelliJ IDEA
// (powered by Fernflower decompiler)
//

package com.techstack.demo.mapper;

import com.techstack.demo.vo.Address;
import com.techstack.demo.vo.AddressVO;
import com.techstack.demo.vo.CountryCode;
import com.techstack.demo.vo.Address.AddressBuilder;
import com.techstack.demo.vo.AddressVO.AddressVOBuilder;
import org.springframework.stereotype.Component;

@Component
public class AddressMapperImpl implements AddressMapper {
    public AddressMapperImpl() {
    }

    public AddressVO addressToAddressVO(Address address) {
        if (address == null) {
            return null;
        } else {
            AddressVOBuilder addressVO = AddressVO.builder();
            addressVO.countryName(this.addressCountryCodeLocalName(address));
            addressVO.countryCode(this.addressCountryCodeCode(address));
            addressVO.streetName(address.getStreetName());
            addressVO.streetSuffix(address.getStreetSuffix());
            addressVO.postalCode(address.getPostalCode());
            addressVO.houseNumberExtension(address.getHouseNumberExtension());
            addressVO.cityName(address.getCityName());
            addressVO.houseNumber(Integer.toString(address.getHouseNumber()));
            return addressVO.build();
        }
    }

    public Address addressVOToAddress(AddressVO addressVO) {
        if (addressVO == null) {
            return null;
        } else {
            AddressBuilder address = Address.builder();
            if (addressVO.getCountryCode() != null) {
                address.countryCode((CountryCode)Enum.valueOf(CountryCode.class, addressVO.getCountryCode()));
            }

            address.cityName(addressVO.getCityName());
            if (addressVO.getHouseNumber() != null) {
                address.houseNumber(Integer.parseInt(addressVO.getHouseNumber()));
            }

            address.houseNumberExtension(addressVO.getHouseNumberExtension());
            address.postalCode(addressVO.getPostalCode());
            address.streetName(addressVO.getStreetName());
            address.streetSuffix(addressVO.getStreetSuffix());
            return address.build();
        }
    }

    private String addressCountryCodeLocalName(Address address) {
        if (address == null) {
            return null;
        } else {
            CountryCode countryCode = address.getCountryCode();
            if (countryCode == null) {
                return null;
            } else {
                String localName = countryCode.getLocalName();
                return localName == null ? null : localName;
            }
        }
    }

    private String addressCountryCodeCode(Address address) {
        if (address == null) {
            return null;
        } else {
            CountryCode countryCode = address.getCountryCode();
            if (countryCode == null) {
                return null;
            } else {
                String code = countryCode.getCode();
                return code == null ? null : code;
            }
        }
    }
}
```

Run the ```TestAddress``` class to see the magic of MapStruct.